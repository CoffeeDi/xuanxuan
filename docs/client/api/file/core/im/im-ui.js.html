<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">core/im/im-ui.js | API</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-vue.css"><link rel="stylesheet" href="./inject/css/0-app.css"><link rel="stylesheet" href="./inject/css/0-esdoc.css"><script src="./inject/script/0-custom.js"></script><meta name="description" content="&#x4F01;&#x4E1A;&#x5373;&#x65F6;&#x901A;&#x8BAF;&#x5E73;&#x53F0;"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="API"><meta property="twitter:description" content="&#x4F01;&#x4E1A;&#x5373;&#x65F6;&#x901A;&#x8BAF;&#x5E73;&#x53F0;"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/easysoft/xuanxuan.git"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/events.js~Events.html">Events</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createCommandObject">createCommandObject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-executeCommand">executeCommand</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-executeCommandLine">executeCommandLine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getCommandContext">getCommandContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-registerCommand">registerCommand</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setCommandContext">setCommandContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unregisterCommand">unregisterCommand</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addContextMenuCreator">addContextMenuCreator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getInnerMenuItemsForContext">getInnerMenuItemsForContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getMenuItemsForContext">getMenuItemsForContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getMenuItemsFromCreator">getMenuItemsFromCreator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isCreatorMatch">isCreatorMatch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isDividerItem">isDividerItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeContextMenuCreator">removeContextMenuCreator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-showContextMenu">showContextMenu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tryAddDividerItem">tryAddDividerItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tryRemoveLastDivider">tryRemoveLastDivider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-deptsSorter">deptsSorter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-forEachMember">forEachMember</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getAllMembers">getAllMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getDept">getDept</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getDeptsTree">getDeptsTree</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getMember">getMember</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getRoleName">getRoleName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-guessMember">guessMember</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initDepts">initDepts</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initMembers">initMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onMembersChange">onMembersChange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-queryMembers">queryMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeMember">removeMember</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateMembers">updateMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isMatchWindowCondition">isMatchWindowCondition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onNoticeUpdate">onNoticeUpdate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateNotice">updateNotice</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ready">ready</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sayReady">sayReady</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-completeDragNDrop">completeDragNDrop</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-disableGlobalShortcut">disableGlobalShortcut</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-emitAppLinkClick">emitAppLinkClick</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-enableGlobalShortcut">enableGlobalShortcut</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getUrlMeta">getUrlMeta</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isAutoLoginNextTime">isAutoLoginNextTime</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isSmallScreen">isSmallScreen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onAppLinkClick">onAppLinkClick</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onReady">onReady</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openUrl">openUrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openUrlInApp">openUrlInApp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openUrlInBrowser">openUrlInBrowser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-openUrlInDialog">openUrlInDialog</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-registerShortcut">registerShortcut</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-reloadWindow">reloadWindow</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setTitle">setTitle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-showMobileChatsMenu">showMobileChatsMenu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-triggerReady">triggerReady</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unregisterGlobalShortcut">unregisterGlobalShortcut</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-contextMenuCreators">contextMenuCreators</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DATA_CHANGE_DELAY">DATA_CHANGE_DELAY</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-events">events</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-app">app</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-depts">depts</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-members">members</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-roles">roles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEFAULT">DEFAULT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-requestAttention">requestAttention</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isReadyed">isReadyed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-clearCopyCodeTip">clearCopyCodeTip</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-entryParams">entryParams</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-globalHotkeys">globalHotkeys</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isGlobalShortcutDisabled">isGlobalShortcutDisabled</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-maxUrlCacheSize">maxUrlCacheSize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-quit">quit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-urlMetaCaches">urlMetaCaches</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#db">db</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/db/database.js~Database.html">Database</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DB_VERSION">DB_VERSION</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lastCreateDb">lastCreateDb</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-db">db</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#im">im</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-countChatMessages">countChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createChatMessage">createChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createCountMessagesTask">createCountMessagesTask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-deleteLocalMessage">deleteLocalMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-forEachChat">forEachChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getAllChats">getAllChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChat">getChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChatCategories">getChatCategories</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChatFiles">getChatFiles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChatMessages">getChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChatMessagesInQueue">getChatMessagesInQueue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getContactChat">getContactChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getContactsChats">getContactsChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getGroupsChats">getGroupsChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLastActiveChat">getLastActiveChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLastRecentChat">getLastRecentChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getOne2OneChatGid">getOne2OneChatGid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getPublicChats">getPublicChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getRecentChats">getRecentChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initChats">initChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadChatMessages">loadChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatMessages">onChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatsInit">onChatsInit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onFetchQueueFinish">onFetchQueueFinish</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-processChatMessageQueue">processChatMessageQueue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-queryChats">queryChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeChat">removeChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-saveChatMessages">saveChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-searchChatMessages">searchChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-searchChats">searchChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateChatMessages">updateChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateChats">updateChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updatePublicChats">updatePublicChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkFileCache">checkFileCache</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkUploadFileSize">checkUploadFileSize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-downloadFile">downloadFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadFiles">loadFiles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-searchFiles">searchFiles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-uploadFile">uploadFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-uploadImageFile">uploadImageFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getPlainTextOfChatMessage">getPlainTextOfChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-runChatNoticeTask">runChatNoticeTask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatAddmember">chatAddmember</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatCategory">chatCategory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatChangename">chatChangename</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatChangepublic">chatChangepublic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatCreate">chatCreate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatDismiss">chatDismiss</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatGetlist">chatGetlist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatGetpubliclist">chatGetpubliclist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatHide">chatHide</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatHistory">chatHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatJoinchat">chatJoinchat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatMessage">chatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatMute">chatMute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatNotify">chatNotify</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatSetcomitters">chatSetcomitters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatStar">chatStar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createBoardChatMessage">createBoardChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createChat">createChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createChatWithMembers">createChatWithMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createEmojiChatMessage">createEmojiChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createLocalChatWithMembers">createLocalChatWithMembers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createTextChatMessage">createTextChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createUrlObjectMessage">createUrlObjectMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dimissChat">dimissChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-exitChat">exitChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetchChatsHistory">fetchChatsHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetchPublicChats">fetchPublicChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleInitChats">handleInitChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-handleReceiveChatMessages">handleReceiveChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-inviteMembersToChat">inviteMembersToChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isFetchingHistory">isFetchingHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-joinChat">joinChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-kickOfMemberFromChat">kickOfMemberFromChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatHistory">onChatHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatHistoryEnd">onChatHistoryEnd</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatHistoryStart">onChatHistoryStart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onReceiveChatMessages">onReceiveChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onSendChatMessages">onSendChatMessages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-renameChat">renameChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendBoardChatMessage">sendBoardChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendChatMessage">sendChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendEmojiMessage">sendEmojiMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendFileMessage">sendFileMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendImageAsBase64">sendImageAsBase64</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendImageMessage">sendImageMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendSocketMessageForChat">sendSocketMessageForChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendTextMessage">sendTextMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setChatCategory">setChatCategory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setCommitters">setCommitters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toggleChatPublic">toggleChatPublic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toggleChatStar">toggleChatStar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toggleHideChat">toggleHideChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toggleMuteChat">toggleMuteChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-updateChatHistory">updateChatHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-activeAndMapCacheChats">activeAndMapCacheChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-activeChat">activeChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-activeLastChat">activeLastChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-captureAndCutScreenImage">captureAndCutScreenImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatDismissConfirm">chatDismissConfirm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatExitConfirm">chatExitConfirm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatRenamePrompt">chatRenamePrompt</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createCatureScreenContextMenuItems">createCatureScreenContextMenuItems</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createGroupChat">createGroupChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-emitChatSendboxFocus">emitChatSendboxFocus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasMessageContextMenu">hasMessageContextMenu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isActiveChat">isActiveChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-linkMembersInText">linkMembersInText</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mapCacheChats">mapCacheChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onActiveChat">onActiveChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onChatSendboxFocus">onChatSendboxFocus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onRenderChatMessageContent">onRenderChatMessageContent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onSendContentToChat">onSendContentToChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onSuggestSendImage">onSuggestSendImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-renameChatCategory">renameChatCategory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-renderChatMessageContent">renderChatMessageContent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sendContentToChat">sendContentToChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CHATS_LIMIT_DEFAULT">CHATS_LIMIT_DEFAULT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MAX_RECENT_TIME">MAX_RECENT_TIME</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEARCH_SCORE_MAP">SEARCH_SCORE_MAP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-app">app</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-chats">chats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-fetchChatMessagesQueue">fetchChatMessagesQueue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isGetChatMessagesQueueBusy">isGetChatMessagesQueueBusy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-publicChats">publicChats</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MIN_PROGRESS_CHANGE_INTERVAL">MIN_PROGRESS_CHANGE_INTERVAL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lastNoticeChat">lastNoticeChat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lastNoticeInfo">lastNoticeInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-updateChatNoticeTask">updateChatNoticeTask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MAX_BASE64_IMAGE_SIZE">MAX_BASE64_IMAGE_SIZE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-chatJoinTask">chatJoinTask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-historyFetchingPager">historyFetchingPager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-activeCaches">activeCaches</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-activedChatId">activedChatId</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-onRenderChatMessageContentListener">onRenderChatMessageContentListener</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#models">models</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/chat-message.js~ChatMessage.html">ChatMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/chat.js~Chat.html">Chat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/entity-schema.js~EntitySchema.html">EntitySchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/entity.js~Entity.html">Entity</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/file-data.js~FileData.html">FileData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/member.js~Member.html">Member</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/models/notification-message.js~NotificationMessage.html">NotificationMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dataURItoBlob">dataURItoBlob</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CONTENT_TYPES">CONTENT_TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-OBJECT_TYPES">OBJECT_TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEND_WAIT_TIME">SEND_WAIT_TIME</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS">STATUS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TYPES">TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-COMMITTERS_TYPES">COMMITTERS_TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DISMISS_VISIBLE_TIME">DISMISS_VISIBLE_TIME</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS">STATUS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TYPES">TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TYPES">TYPES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-defaultValuesConveter">defaultValuesConveter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CATEGORIES">CATEGORIES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MATCH_SCORE_MAP">MATCH_SCORE_MAP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MATCH_SCORE_MAP">MATCH_SCORE_MAP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STATUS">STATUS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#network">network</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/network/socket-message.js~SocketMessage.html">SocketMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/network/socket.js~AppSocket.html">AppSocket</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkUploadFileSize">checkUploadFileSize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getRanzhiServerInfo">getRanzhiServerInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-requestServerInfo">requestServerInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-listenMessage">listenMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-API">API</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LISTEN_TIMEOUT">LISTEN_TIMEOUT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PING_INTERVAL">PING_INTERVAL</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#profile">profile</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/profile/user-config.js~UserConfig.html">UserConfig</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/core/profile/user.js~User.html">User</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createUser">createUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getCurrentUser">getCurrentUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getLastSavedUser">getLastSavedUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isCurrentUser">isCurrentUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onSwapUser">onSwapUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onUserConfigChange">onUserConfigChange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onUserStatusChange">onUserStatusChange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setCurrentUser">setCurrentUser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isPasswordWithMD5Flag">isPasswordWithMD5Flag</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-user">user</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PASSWORD_WITH_MD5_FLAG">PASSWORD_WITH_MD5_FLAG</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#server">server</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-changeUserStatus">changeUserStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkServerVersion">checkServerVersion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkVersionSupport">checkVersionSupport</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetchUserList">fetchUserList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-login">login</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-logout">logout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onUserLogin">onUserLogin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onUserLoginout">onUserLoginout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tryGetTempUserInfo">tryGetTempUserInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatError">chatError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatKickoff">chatKickoff</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatLogin">chatLogin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatLogout">chatLogout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatSessionID">chatSessionID</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatSettings">chatSettings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatUserChangeStatus">chatUserChangeStatus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatUserchange">chatUserchange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-chatUsergetlist">chatUsergetlist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-MIN_SUPPORT_VERSION">MIN_SUPPORT_VERSION</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TIMEOUT">TIMEOUT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lastGetTempUserCall">lastGetTempUserCall</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-socket">socket</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-tempUserIdList">tempUserIdList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EVENT">EVENT</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#todo">todo</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createTodo">createTodo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createTodoFromMessage">createTodoFromMessage</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">core/im/im-ui.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import Platform from &apos;Platform&apos;;
import Events from &apos;../events&apos;;
import profile from &apos;../profile&apos;;
import chats from &apos;./im-chats&apos;;
import Lang from &apos;../../lang&apos;;
import Server from &apos;./im-server&apos;;
import members from &apos;../members&apos;;
import StringHelper from &apos;../../utils/string-helper&apos;;
import DateHelper from &apos;../../utils/date-helper&apos;;
import Modal from &apos;../../components/modal&apos;;
import ContextMenu from &apos;../../components/context-menu&apos;;
import ChatCommittersSettingDialog from &apos;../../views/chats/chat-committers-setting-dialog&apos;;
import ChatsHistoryDialog from &apos;../../views/chats/chats-history-dialog&apos;;
import ChatInviteDialog from &apos;../../views/chats/chat-invite-dialog&apos;;
import ChatTipPopover from &apos;../../views/chats/chat-tip-popover&apos;;
import EmojiPopover from &apos;../../views/common/emoji-popover&apos;;
import HotkeySettingDialog from &apos;../../views/common/hotkey-setting-dialog&apos;;
import Markdown from &apos;../../utils/markdown&apos;;
import Emojione from &apos;../../components/emojione&apos;;
import ChatChangeFontPopover from &apos;../../views/chats/chat-change-font-popover&apos;;
import db from &apos;../db&apos;;
import ChatAddCategoryDialog from &apos;../../views/chats/chat-add-category-dialog&apos;;
import TodoEditorDialog from &apos;../../views/todo/todo-editor-dialog&apos;;
import Todo from &apos;../todo&apos;;
import {strip, linkify, escape} from &apos;../../utils/html-helper&apos;;
import {
    addContextMenuCreator, getMenuItemsForContext, tryAddDividerItem, tryRemoveLastDivider
} from &apos;../context-menu&apos;;
import ui from &apos;../ui&apos;;
import {registerCommand, executeCommandLine} from &apos;../commander&apos;;

let activedChatId = null;
let activeCaches = {};

/**
 * &#x4E8B;&#x4EF6;&#x8868;
 * @type {Object&lt;string, string&gt;}
 * @private
 */
const EVENT = {
    activeChat: &apos;im.chats.activeChat&apos;,
    sendContentToChat: &apos;im.chats.sendContentToChat&apos;,
    suggestSendImage: &apos;im.chats.suggestSendImage&apos;,
    sendboxFocus: &apos;im.chat.sendbox.focus&apos;
};

const activeChat = chat =&gt; {
    if ((typeof chat === &apos;string&apos;) &amp;&amp; chat.length) {
        chat = chats.get(chat);
    }
    if (chat) {
        if (!activedChatId || chat.gid !== activedChatId) {
            activedChatId = chat.gid;
            Events.emit(EVENT.activeChat, chat);
            ui.showMobileChatsMenu(false);
        }
        const urlHash = window.location.hash;
        if (!urlHash.endsWith(`/${chat.gid}`)) {
            window.location.hash = `#/chats/recents/${chat.gid}`;
        }
        activeCaches[chat.gid] = true;
        if (chat.noticeCount) {
            chat.muteNotice();
            chats.saveChatMessages(chat.messages);
        }
    }
};

const activeLastChat = () =&gt; {
    const lastChat = chats.getLastRecentChat();
    if (lastChat) {
        activeChat(lastChat);
    }
};

const isActiveChat = chatGid =&gt; {
    return activedChatId === chatGid;
};

const onActiveChat = listener =&gt; {
    return Events.on(EVENT.activeChat, listener);
};

const sendContentToChat = (content, type = &apos;text&apos;, cgid = null) =&gt; {
    if (!cgid) {
        cgid = activedChatId;
    }
    if (type === &apos;file&apos;) {
        Server.sendFileMessage(content, chats.get(cgid));
    } else {
        return Events.emit(`${EVENT.sendContentToChat}.${cgid}`, {content, type});
    }
};

const onSendContentToChat = (cgid, listener) =&gt; {
    return Events.on(`${EVENT.sendContentToChat}.${cgid}`, listener);
};

const mapCacheChats = callback =&gt; {
    return Object.keys(activeCaches).map(callback);
};

const activeAndMapCacheChats = (chat, callback) =&gt; {
    activeChat(chat);
    return mapCacheChats(callback);
};

addContextMenuCreator(&apos;chat.toolbar&apos;, context =&gt; {
    let {chat, showSidebarIcon = &apos;auto&apos;} = context;
    const items = [];
    if (!chat.isRobot) {
        items.push({
            id: &apos;star&apos;,
            className: chat.star ? &apos;app-chat-star-icon stared&apos; : &apos;app-chat-star-icon &apos;,
            icon: &apos;star-outline&apos;,
            label: Lang.string(chat.star ? &apos;chat.toolbor.unstar&apos; : &apos;chat.toolbor.star&apos;),
            click: () =&gt; {
                Server.toggleChatStar(chat);
            }
        });
    }
    if (chat.canInvite(profile.user)) {
        items.push({
            id: &apos;invite&apos;,
            icon: &apos;account-multiple-plus&apos;,
            label: Lang.string(&apos;chat.toolbor.invite&apos;),
            click: () =&gt; {
                ChatInviteDialog.show(chat);
            }
        });
    }
    items.push({
        id: &apos;history&apos;,
        icon: &apos;history&apos;,
        label: Lang.string(&apos;chat.toolbor.history&apos;),
        click: () =&gt; {
            ChatsHistoryDialog.show(chat);
        }
    });
    if (chat.isRobot) {
        showSidebarIcon = false;
    }
    if (showSidebarIcon === &apos;auto&apos;) {
        showSidebarIcon = profile.userConfig.isChatSidebarHidden(chat.gid, chat.isOne2One);
    }
    if (showSidebarIcon) {
        items.push({
            id: &apos;sidebar&apos;,
            icon: &apos;book-open&apos;,
            label: Lang.string(&apos;chat.toolbor.sidebar&apos;),
            click: () =&gt; {
                profile.userConfig.setChatSidebarHidden(chat.gid, false);
            }
        });
    }
    const moreItems = getMenuItemsForContext(&apos;chat.toolbar.more&apos;, {chat});
    if (moreItems &amp;&amp; moreItems.length) {
        items.push({
            id: &apos;more&apos;,
            icon: &apos;dots-horizontal&apos;,
            label: Lang.string(&apos;chat.toolbor.more&apos;),
            click: e =&gt; {
                ContextMenu.show({x: e.pageX, y: e.pageY, direction: &apos;bottom-left&apos;}, moreItems);
            }
        });
    }
    items[items.length - 1].hintPosition = &apos;bottom-left&apos;;
    return items;
});

const captureAndCutScreenImage = (hiddenWindows = false) =&gt; {
    if (Platform.screenshot) {
        const captureScreenChatId = activedChatId;
        Platform.screenshot.captureAndCutScreenImage(0, hiddenWindows).then(image =&gt; {
            activeChat(captureScreenChatId);
            return image &amp;&amp; sendContentToChat(image, &apos;image&apos;, captureScreenChatId);
        }).catch(error =&gt; {
            if (DEBUG) {
                console.warn(&apos;Capture screen image error: &apos;, error);
            }
        });
    } else {
        throw new Error(`The platform(${Platform.type}) not support capture screenshot.`);
    }
};

const createCatureScreenContextMenuItems = () =&gt; {
    if (!Platform.screenshot) {
        throw new Error(`The platform(${Platform.type}) not support take screenshots.`);
    }
    const items = [{
        id: &apos;captureScreen&apos;,
        label: Lang.string(&apos;chat.sendbox.toolbar.captureScreen&apos;),
        click: () =&gt; {
            captureAndCutScreenImage();
        }
    }, {
        id: &apos;hideAndCaptureScreen&apos;,
        label: Lang.string(&apos;imageCutter.hideCurrentWindowAndCaptureScreen&apos;),
        click: () =&gt; {
            captureAndCutScreenImage(true);
        }
    }, {
        type: &apos;separator&apos;
    }, {
        id: &apos;captureScreenHotSetting&apos;,
        label: Lang.string(&apos;imageCutter.setGlobalHotkey&apos;),
        click: () =&gt; {
            HotkeySettingDialog.show(Lang.string(&apos;imageCutter.setGlobalHotkey&apos;), profile.userConfig.captureScreenHotkey, newHotKey =&gt; {
                profile.userConfig.captureScreenHotkey = newHotKey;
            });
        }
    }];
    return items;
};

addContextMenuCreator(&apos;chat.sendbox.toolbar&apos;, context =&gt; {
    const {chatGid, openMessagePreview} = context;
    const {userConfig} = profile;
    const items = [{
        id: &apos;emoticon&apos;,
        icon: &apos;mdi-emoticon&apos;,
        label: Lang.string(&apos;chat.sendbox.toolbar.emoticon&apos;),
        click: e =&gt; {
            EmojiPopover.show({x: e.pageX, y: e.pageY, target: e.target, placement: &apos;top&apos;}, emoji =&gt; {
                sendContentToChat(`${Emojione.convert(emoji.unicode || Emojione.emojioneList[emoji.shortname].uc_base)} `);
            });
        }
    }];
    if (profile.user.isVersionSupport(&apos;fileServer&apos;)) {
        items.push({
            id: &apos;image&apos;,
            icon: &apos;mdi-image&apos;,
            label: Lang.string(&apos;chat.sendbox.toolbar.image&apos;),
            click: () =&gt; {
                Platform.dialog.showOpenDialog({
                    filters: [
                        {name: &apos;Images&apos;, extensions: [&apos;jpg&apos;, &apos;png&apos;, &apos;gif&apos;]},
                    ]
                }, files =&gt; {
                    if (files &amp;&amp; files.length) {
                        sendContentToChat(files[0], &apos;image&apos;, chatGid);
                    }
                });
            }
        }, {
            id: &apos;file&apos;,
            icon: &apos;mdi-file-outline&apos;,
            label: Lang.string(&apos;chat.sendbox.toolbar.file&apos;),
            click: () =&gt; {
                Platform.dialog.showOpenDialog(null, files =&gt; {
                    if (files &amp;&amp; files.length) {
                        Server.sendFileMessage(files[0], chats.get(chatGid));
                    }
                });
            }
        });
    }
    if (Platform.screenshot &amp;&amp; userConfig) {
        items.push({
            id: &apos;captureScreen&apos;,
            icon: &apos;mdi-content-cut rotate-270 inline-block&apos;,
            label: `${Lang.string(&apos;chat.sendbox.toolbar.captureScreen&apos;)} ${(userConfig.captureScreenHotkey || &apos;&apos;)} (${Lang.string(&apos;chat.sendbox.toolbar.moreOptions&apos;)})`,
            click: () =&gt; {
                captureAndCutScreenImage();
            },
            contextMenu: e =&gt; {
                ContextMenu.show({x: e.pageX, y: e.pageY}, createCatureScreenContextMenuItems(chats.get(chatGid)));
                e.preventDefault();
            }
        });
    }
    items.push({
        id: &apos;setFontSize&apos;,
        icon: &apos;mdi-format-size&apos;,
        label: Lang.string(&apos;chat.sendbox.toolbar.setFontSize&apos;),
        click: e =&gt; {
            ChatChangeFontPopover.show({x: e.pageX, y: e.pageY, target: e.target, placement: &apos;top&apos;});
        }
    });
    const sendMarkdown = userConfig &amp;&amp; userConfig.sendMarkdown;
    items.push({
        id: &apos;markdown&apos;,
        icon: sendMarkdown ? &apos;mdi-markdown icon-2x&apos; : &apos;mdi-markdown icon-2x&apos;,
        label: Lang.string(sendMarkdown ? &apos;chat.sendbox.toolbar.markdown.enabled&apos; : &apos;chat.sendbox.toolbar.markdown.disabled&apos;) + (sendMarkdown ? ` (${Lang.string(&apos;chat.sendbox.toolbar.moreOptions&apos;)})` : &apos;&apos;),
        className: sendMarkdown ? &apos;selected text-green&apos; : &apos;&apos;,
        click: () =&gt; {
            userConfig.sendMarkdown = !userConfig.sendMarkdown;
        },
        contextMenu: sendMarkdown ? e =&gt; {
            const menuItems = [{
                label: Lang.string(&apos;chat.sendbox.toolbar.previewDraft&apos;),
                click: openMessagePreview,
                icon: &apos;mdi-file-find&apos;,
                disabled: !openMessagePreview
            }, {
                icon: &apos;mdi-help-circle&apos;,
                label: Lang.string(&apos;chat.sendbox.toolbar.markdownGuide&apos;),
                url: `!openUrlInDialog/${encodeURIComponent(&apos;http://wowubuntu.com/markdown/&apos;)}/?size=lg&amp;insertCss=${encodeURIComponent(&apos;.wikistyle&gt;p:first-child{display:none!important}&apos;)}`
            }];
            ui.showContextMenu({x: e.pageX, y: e.pageY, target: e.target, placement: &apos;top&apos;}, menuItems);
            e.preventDefault();
        } : null
    });
    if (userConfig &amp;&amp; userConfig.showMessageTip) {
        items.push({
            id: &apos;tips&apos;,
            icon: &apos;mdi-comment-question-outline&apos;,
            label: Lang.string(&apos;chat.sendbox.toolbar.tips&apos;),
            click: e =&gt; {
                ChatTipPopover.show({x: e.pageX, y: e.pageY, target: e.target, placement: &apos;top&apos;});
            }
        });
    }
    return items;
});

const chatRenamePrompt = chat =&gt; {
    return Modal.prompt(Lang.string(&apos;chat.rename.title&apos;), chat.name, {
        placeholder: Lang.string(&apos;chat.rename.newTitle&apos;),
    }).then(newName =&gt; {
        if (chat.name !== newName) {
            Server.renameChat(chat, newName);
        }
    });
};

const chatExitConfirm = chat =&gt; {
    return Modal.confirm(Lang.format(&apos;chat.group.exitConfirm&apos;, chat.getDisplayName({members, user: profile.user}))).then(result =&gt; {
        if (result) {
            Server.exitChat(chat);
        }
    });
};

const chatDismissConfirm = chat =&gt; {
    return Modal.confirm(Lang.format(&apos;chat.group.dismissConfirm&apos;, chat.getDisplayName({members, user: profile.user}))).then(result =&gt; {
        if (result) {
            return Server.dimissChat(chat).then(theChat =&gt; {
                if (theChat) {
                    activeLastChat();
                }
                return Promise.resolve(theChat);
            });
        }
    });
};

addContextMenuCreator(&apos;chat.menu&apos;, context =&gt; {
    const {chat, menuType = null, viewType = null} = context;
    const menu = [];
    if (chat.isOne2One) {
        menu.push(...getMenuItemsForContext(&apos;member&apos;, {member: chat.getTheOtherOne({members, user: profile.user})}));
        tryAddDividerItem(menu);
    }

    if (!chat.isRobot) {
        menu.push({
            label: Lang.string(chat.star ? &apos;chat.toolbor.unstar&apos; : &apos;chat.toolbor.star&apos;),
            click: () =&gt; {
                Server.toggleChatStar(chat);
            }
        });

        if (profile.user.isVersionSupport(&apos;muteChat&apos;)) {
            menu.push({
                label: Lang.string(chat.mute ? &apos;chat.toolbar.cancelMute&apos; : &apos;chat.toolbar.mute&apos;),
                click: () =&gt; {
                    Server.toggleMuteChat(chat);
                }
            });
        }
    }

    if (chat.canRename(profile.user)) {
        menu.push({
            label: Lang.string(&apos;common.rename&apos;),
            click: () =&gt; {
                chatRenamePrompt(chat);
            }
        });
    }

    if (chat.canMakePublic(profile.user)) {
        menu.push({
            label: Lang.string(chat.public ? &apos;chat.public.setPrivate&apos; : &apos;chat.public.setPublic&apos;),
            click: () =&gt; {
                Server.toggleChatPublic(chat);
            }
        });
    }

    if (chat.canDismiss(profile.user)) {
        tryAddDividerItem(menu);
        menu.push({
            label: Lang.string(&apos;chat.group.dismiss&apos;),
            click: () =&gt; {
                chatDismissConfirm(chat);
            }
        });
    }

    if (chat.canExit(profile.user)) {
        tryAddDividerItem(menu);
        menu.push({
            label: Lang.string(&apos;chat.group.exit&apos;),
            click: () =&gt; {
                chatExitConfirm(chat);
            }
        });
    }

    if (!chat.isDismissed &amp;&amp; !chat.isRobot) {
        tryAddDividerItem(menu);
        if (viewType === &apos;category&apos; &amp;&amp; (menuType === &apos;contacts&apos; || menuType === &apos;groups&apos;)) {
            menu.push({
                label: Lang.string(&apos;chats.menu.group.add&apos;),
                click: () =&gt; {
                    ChatAddCategoryDialog.show(chat);
                }
            });
        }
        if (chat.canHide &amp;&amp; profile.user.isVersionSupport(&apos;hideChat&apos;)) {
            menu.push({
                label: Lang.string(chat.hidden ? &apos;chat.toolbar.cancelHide&apos; : &apos;chat.toolbar.hide&apos;),
                click: () =&gt; {
                    Server.toggleHideChat(chat);
                }
            });
        }
    }

    return tryRemoveLastDivider(menu);
});

addContextMenuCreator(&apos;chat.toolbar.more&apos;, ({chat}) =&gt; {
    if (chat.isOne2One) return [];
    const menu = [];
    if (profile.user.isVersionSupport(&apos;muteChat&apos;)) {
        menu.push({
            label: Lang.string(chat.mute ? &apos;chat.toolbar.cancelMute&apos; : &apos;chat.toolbar.mute&apos;),
            click: () =&gt; {
                Server.toggleMuteChat(chat);
            }
        });
    }
    if (chat.canRename(profile.user)) {
        menu.push({
            label: Lang.string(&apos;common.rename&apos;),
            click: () =&gt; {
                chatRenamePrompt(chat);
            }
        });
    }

    if (chat.canMakePublic(profile.user)) {
        menu.push({
            label: Lang.string(chat.public ? &apos;chat.public.setPrivate&apos; : &apos;chat.public.setPublic&apos;),
            click: () =&gt; {
                Server.toggleChatPublic(chat);
            }
        });
    }

    if (chat.canSetCommitters(profile.user)) {
        menu.push({
            label: Lang.string(&apos;chat.committers.setCommitters&apos;),
            click: () =&gt; {
                ChatCommittersSettingDialog.show(chat);
            }
        });
    }

    if (chat.canDismiss(profile.user)) {
        if (menu.length) {
            menu.push({type: &apos;separator&apos;});
        }
        menu.push({
            label: Lang.string(&apos;chat.group.dismiss&apos;),
            click: () =&gt; {
                chatDismissConfirm(chat);
            }
        });
    }

    if (chat.canExit(profile.user)) {
        if (menu.length) {
            menu.push({type: &apos;separator&apos;});
        }
        menu.push({
            label: Lang.string(&apos;chat.group.exit&apos;),
            click: () =&gt; {
                chatExitConfirm(chat);
            }
        });
    }
    return menu;
});

addContextMenuCreator(&apos;chat.member&apos;, ({member, chat}) =&gt; {
    const menu = [];
    if (member.account !== profile.userAccount &amp;&amp; chat.isGroupOrSystem) {
        const one2OneGid = chats.getOne2OneChatGid([member, profile.user]);
        menu.push({
            label: Lang.string(`chat.atHim.${member.gender}`, Lang.string(&apos;chat.atHim&apos;)),
            click: () =&gt; {
                sendContentToChat(`@${member.displayName} `);
            }
        }, {
            label: Lang.string(&apos;chat.sendMessage&apos;),
            click: () =&gt; {
                window.location.hash = `#/chats/contacts/${one2OneGid}`;
            }
        });
    }

    tryAddDividerItem(menu);
    menu.push(...getMenuItemsForContext(&apos;member&apos;, {member}));

    if (chat.canKickOff(profile.user, member)) {
        tryAddDividerItem(menu);
        menu.push({
            label: Lang.string(&apos;chat.kickOffFromGroup&apos;),
            click: () =&gt; {
                return Modal.confirm(Lang.format(&apos;chat.kickOffFromGroup.confirm&apos;, member.displayName)).then(result =&gt; {
                    if (result) {
                        return Server.kickOfMemberFromChat(chat, member);
                    }
                    return Promise.reject();
                });
            }
        });
    }
    return menu;
});

const linkMembersInText = (text, {format = &apos;&lt;a class=&quot;app-link {className}&quot; data-url=&quot;@Member/{id}&quot;&gt;@{displayName}&lt;/a&gt;&apos;}) =&gt; {
    if (text &amp;&amp; text.indexOf(&apos;@&apos;) &gt; -1) {
        const langAtAll = Lang.string(&apos;chat.message.atAll&apos;);
        const userAccount = profile.userAccount;
        text = text.replace(/@([\w\u4e00-\u9fa5]+)/g, (mentionAt, mention) =&gt; {
            const m = members.guess(mention);
            if (m) {
                return StringHelper.format(format, {displayName: m.displayName, id: m.id, account: m.account, className: m.account === userAccount ? &apos;at-me&apos; : &apos;&apos;});
            } else if (mention === &apos;all&apos; || mention === langAtAll) {
                return `&lt;span class=&quot;at-all&quot;&gt;@${langAtAll}&lt;/span&gt;`;
            }
            return mentionAt;
        });
    }
    return text;
};

let onRenderChatMessageContentListener = null;
const renderChatMessageContent = (messageContent, {renderMarkdown = false}) =&gt; {
    if (typeof messageContent === &apos;string&apos; &amp;&amp; messageContent.length) {
        if (renderMarkdown) {
            messageContent = Markdown(messageContent);
        } else {
            messageContent = linkify(escape(messageContent));
        }
        messageContent = Emojione.toImage(messageContent);
        if (onRenderChatMessageContentListener) {
            messageContent = onRenderChatMessageContentListener(messageContent);
        }
    }
    return messageContent;
};

const onRenderChatMessageContent = listener =&gt; {
    onRenderChatMessageContentListener = listener;
};

const createGroupChat = (groupMembers) =&gt; {
    return Modal.prompt(Lang.string(&apos;chat.create.newChatNameTip&apos;), &apos;&apos;, {
        inputProps: {placeholder: Lang.string(&apos;chat.rename.newTitle&apos;)},
        onSubmit: newName =&gt; {
            if (!newName) {
                Modal.alert(Lang.string(&apos;chat.rename.newTitleRequired&apos;));
                return false;
            }
        }
    }).then(newName =&gt; {
        if (newName) {
            return Server.createChatWithMembers(groupMembers, {name: newName});
        }
        return Promise.reject(false);
    });
};

const renameChatCategory = (group, type = &apos;contact&apos;, newCategoryName = null) =&gt; {
    if (newCategoryName === null) {
        return Modal.prompt(Lang.string(&apos;chats.menu.group.renameTip&apos;), group.title).then(name =&gt; {
            return renameChatCategory(group, type, name);
        });
    }
    if (newCategoryName !== group.title) {
        if (group.id) {
            const isContactType = type === &apos;contact&apos;;
            const renameChats = chats.query(x =&gt; ((isContactType ? x.isOne2One : x.isGroupOrSystem) &amp;&amp; x.category === group.id), false);
            return Server.setChatCategory(renameChats, newCategoryName).then(() =&gt; {
                const categoriesConfigName = isContactType ? &apos;contactsCategories&apos; : &apos;groupsCategories&apos;;
                const categories = profile.user.config[categoriesConfigName];
                if (!categories[newCategoryName]) {
                    categories[newCategoryName] = categories[group.id];
                }
                delete categories[group.id];
                profile.user.config[categoriesConfigName] = categories;
            });
        } else {
            profile.user.config[type === &apos;contact&apos; ? &apos;contactsDefaultCategoryName&apos; : &apos;groupsDefaultCategoryName&apos;] = newCategoryName;
        }
    }
};

addContextMenuCreator(&apos;chat.group&apos;, ({group, type = &apos;contact&apos;}) =&gt; {
    const menus = [];
    if (!group.system) {
        menus.push({
            label: Lang.string(&apos;chats.menu.group.rename&apos;),
            click: () =&gt; {
                renameChatCategory(group, type);
            }
        });
    }
    if (group.id &amp;&amp; !group.system) {
        menus.push({
            label: Lang.string(&apos;chats.menu.group.delete&apos;),
            click: () =&gt; {
                const defaultCategoryName = profile.user.config[type === &apos;contact&apos; ? &apos;contactsDefaultCategoryName&apos; : &apos;groupsDefaultCategoryName&apos;] || Lang.string(&apos;chats.menu.group.default&apos;);
                return Modal.confirm(Lang.format(&apos;chats.menu.group.delete.tip.format&apos;, defaultCategoryName), {
                    title: Lang.format(&apos;chats.menu.group.delete.confirm.format&apos;, group.title)
                }).then(result =&gt; {
                    return result &amp;&amp; renameChatCategory(group, type, &apos;&apos;);
                });
            }
        });
    }
    return menus;
});

const hasMessageContextMenu = message =&gt; {
    return message.isTextContent &amp;&amp; Platform.clipboard &amp;&amp; Platform.clipboard.writeText;
};

addContextMenuCreator(&apos;message.text&apos;, ({message}) =&gt; {
    const items = [];
    if (message.isTextContent &amp;&amp; Platform.clipboard &amp;&amp; Platform.clipboard.writeText) {
        items.push({
            icon: &apos;mdi-content-copy&apos;,
            label: Lang.string(&apos;chat.message.copy&apos;),
            click: () =&gt; {
                let copyHtmlText = message.isPlainTextContent ? message.content : null;
                let copyPlainText = message.content;
                if (copyHtmlText === null) {
                    const contentElement = document.getElementById(`message-content-${message.gid}`);
                    if (contentElement) {
                        copyHtmlText = contentElement.innerHTML;
                        copyPlainText = contentElement.innerText;
                    }
                }
                if (copyHtmlText === undefined) {
                    copyHtmlText = message.renderedTextContent(renderChatMessageContent, linkMembersInText);
                }
                if (Platform.clipboard.write) {
                    Platform.clipboard.write({text: message.isPlainTextContent ? copyHtmlText : strip(copyHtmlText), html: copyHtmlText});
                } else if (Platform.clipboard.writeHTML) {
                    Platform.clipboard.writeHTML(copyHtmlText);
                } else if (Platform.clipboard.writeText) {
                    Platform.clipboard.writeText(copyPlainText);
                }
            }
        });
        if (!message.isPlainTextContent) {
            items.push({
                icon: &apos;mdi-markdown&apos;,
                label: Lang.string(&apos;chat.message.copyMarkdown&apos;),
                click: () =&gt; {
                    Platform.clipboard.writeText(message.content);
                }
            });
        }
    }
    if (profile.user.isVersionSupport(&apos;todo&apos;)) {
        if (items.length) {
            items.push(&apos;divider&apos;);
        }
        items.push({
            label: Lang.string(&apos;todo.create&apos;),
            icon: &apos;mdi-calendar-check&apos;,
            click: (item, idx, e) =&gt; {
                TodoEditorDialog.show(Todo.createTodoFromMessage(message));
                e.preventDefault();
            }
        });
    }
    return items;
});

profile.onSwapUser(user =&gt; {
    activedChatId = null;
    activeCaches = {};
});

chats.onChatsInit(initChats =&gt; {
    if (!activedChatId) {
        const lastActiveChat = chats.getLastActiveChat();
        if (lastActiveChat) {
            activedChatId = lastActiveChat &amp;&amp; lastActiveChat.gid;
            lastActiveChat.makeActive();
            if (window.location.hash.startsWith(&apos;#/chats/&apos;)) {
                window.location.hash = `#/chats/recents/${activedChatId}`;
            }
        }
    }
    if (!db.database.isExists) {
        Server.fetchChatsHistory(&apos;all&apos;, DateHelper.getTimeBeforeDesc(&apos;threeMonth&apos;));
        if (DEBUG) {
            console.color(&apos;Fetch all history for new database&apos;, &apos;greenPale&apos;);
        }
    }
});

if (Platform.screenshot) {
    registerCommand(&apos;shortcut.captureScreenHotkey&apos;, () =&gt; {
        captureAndCutScreenImage();
    });
}

if (Platform.clipboard &amp;&amp; Platform.clipboard.getNewImage) {
    registerCommand(&apos;suggestClipboardImage&apos;, () =&gt; {
        if (!profile.userConfig.listenClipboardImage) {
            return;
        }
        const newImage = Platform.clipboard.getNewImage();
        if (newImage) {
            Events.emit(EVENT.suggestSendImage, newImage);
        }
    });
}

const onSuggestSendImage = (listener) =&gt; {
    return Events.on(EVENT.suggestSendImage, listener);
};

const emitChatSendboxFocus = (chat, sendboxContent) =&gt; {
    Events.emit(EVENT.sendboxFocus, chat, sendboxContent);
    if (profile.userConfig.listenClipboardImage &amp;&amp; StringHelper.isEmpty(sendboxContent)) {
        executeCommandLine(&apos;suggestClipboardImage&apos;);
    }
};

const onChatSendboxFocus = (listener) =&gt; {
    return Events.on(EVENT.sendboxFocus, listener);
};

export default {
    activeChat,
    activeLastChat,
    onActiveChat,
    mapCacheChats,
    isActiveChat,
    activeAndMapCacheChats,
    linkMembersInText,
    renderChatMessageContent,
    chatExitConfirm,
    chatRenamePrompt,
    createGroupChat,
    sendContentToChat,
    onSendContentToChat,
    onRenderChatMessageContent,
    onSuggestSendImage,
    hasMessageContextMenu,
    emitChatSendboxFocus,
    onChatSendboxFocus,

    get currentActiveChatId() {
        return activedChatId;
    },

    get currentActiveChat() {
        return activedChatId &amp;&amp; chats.get(activedChatId);
    },
};
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
